day
day1  <- colMeans(rbind(yday(sch$Arrival),yday(sch$Departure)))
day2  <- colMeans(rbind(yday(sch$Arrival[-1]),yday(sch$Departure[-nrow(sch)])))
day <- c(day1[1],rbind(day2,day1[-1]))
day1  <- colMeans(rbind(yday(sch$Arrival),yday(sch$Departure)))
day2  <- colMeans(rbind(yday(sch$Arrival[-1]),yday(sch$Departure[-nrow(sch)])))
day <- c(day1[1],rbind(day2,day1[-1]))
day
length(day)
length(p)
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
sch
names(tblLog)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=1
)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
c(tblLog$Lat[i], sch[1,8])
c(tblLog$Lon[i],sch[1,7])
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
sch
arrows(sm[,7], sm[,11], sm[,7], sm[,13], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(sm[,14], sm[,8], sm[,17], sm[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(sch[,7], sch[,11], sch[,7], sch[,13], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(sch[,14], sch[,8], sch[,17], sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
sch[,7]
?arrows
arrows(sch[,7], sch[,14], sch[,7], sch[,17], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
sch[,7]
sch[,14]
sch[,17]
sch
sch$Lat.2.5%
sch$Lat.2.5%
sch[,14]
sch[,14]
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,11]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
sch
sch[,11]
sch[,14]
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+4))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
c(rbind(rep("",nrow(sch)),sch[,1]),"")
sch[,1]
c(rbind(rep("",nrow(sch)),as.character(sch[,1])),"")
sch[,2]
sch[,3]
tblLog$AnalyseStartDate
tblLog$AnalyseStartDate[i]
sch[,2]
tblLog$AnalyseEndDate[i]
sch[,3]
tblLog$LogONdate
tblLog$LogONdate[i]
tblLog$LogOFFDate[i]
sch[,3]
sch[,2]
sch[1,]
sch[1,]
sch[7,]-tblLog$Lon[i]
shift1Lon <- sch[1,7]-tblLog$Lon[i]
shift1Lat <- sch[1,8]-tblLog$Lat[i]
shift2Lon <- sch[nrow(sch),7]-tblLog$Lon[i]
shift2Lat <- sch[nrow(sch),8]-tblLog$Lat[i]
sch[8,17,1]
sch[8:17,1]
sch[1,8:17]
sch[1,8:17]
sch[1,c(7:8,10:17)]
sch[1,c(7:8,10:17)]
shift1Lon
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- sch[nrow(sch),7]-tblLog$Lon[i]
shift2Lat <- sch[nrow(sch),8]-tblLog$Lat[i]
sch[1,c(7,10:13)] <- sch[1,c(7,10:13)]+shift1Lon
sch[1,c(7,10:13)]+shift1Lon
as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift21Lat
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
sch
load(schName)
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- sch[nrow(sch),7]-tblLog$Lon[i]
shift2Lat <- sch[nrow(sch),8]-tblLog$Lat[i]
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
sch
load(schName)
sch
tblLog$Lon[i]
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- tblLog$Lon[i]-sch[nrow(sch),7]
shift2Lat <- tblLog$Lat[i]-sch[nrow(sch),8]
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
sch
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
day
nrow(sch)
length(day)
day1  <- colMeans(rbind(yday(sch$Arrival),yday(sch$Departure)))
day2  <- colMeans(rbind(yday(sch$Arrival[-1]),yday(sch$Departure[-nrow(sch)])))
day1
day2
apply(rbind(yday(sch$Arrival),yday(sch$Departure)),2,median)
day1  <- apply(rbind(yday(sch$Arrival),yday(sch$Departure)),2,median)
day2  <- apply(rbind(yday(sch$Arrival[-1]),yday(sch$Departure[-nrow(sch)])),2,median)
day <- c(day1[1],rbind(day2,day1[-1]))
day
rbind(yday(sch$Arrival[-1]),yday(sch$Departure[-nrow(sch)]))
as.POSIXlt(sch$Arrival, origin = "1970-01-01", tz  ="GMT")
rbind(as.POSIXlt(sch$Arrival, origin = "1970-01-01", tz  ="GMT"),as.POSIXlt(sch$Departure, origin = "1970-01-01", tz  ="GMT"))
apply(rbind(as.POSIXlt(sch$Arrival, origin = "1970-01-01", tz  ="GMT"),as.POSIXlt(sch$Departure, origin = "1970-01-01", tz  ="GMT")),2,median)
day <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
day[(j-1)*2+1] <- difftime(sch$Departure[j],sch$Arrival[j],unit="days")
if(j!=nrow(sch)) day[j*2] <- difftime(sch$Arrival[j+1],sch$Departure[j],unit="days")
}
day
p
day <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
day[(j-1)*2+1] <- median(sch$Departure[j],sch$Arrival[j])
if(j!=nrow(sch)) day[j*2] <- median(sch$Arrival[j+1],sch$Departure[j])
}
day
day <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
day[(j-1)*2+1] <- yday(median(sch$Departure[j],sch$Arrival[j]))
if(j!=nrow(sch)) day[j*2] <- yday(median(sch$Arrival[j+1],sch$Departure[j]))
}
day
# Load the Geolocator data for this logger
# Coordinates
load(fitName)
# Sites
load(mGName)
# Timing
load(schName)
# Creat a table summarizing all stationary periods
# The first and the last site are in breeding habitat
day <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
day[(j-1)*2+1] <- yday(median(sch$Departure[j],sch$Arrival[j]))
if(j!=nrow(sch)) day[j*2] <- yday(median(sch$Arrival[j+1],sch$Departure[j]))
}
p1  <- yday(sch$Departure) - yday(sch$Arrival)
p2  <- yday(sch$Arrival[-1]) - yday(sch$Departure[-nrow(sch)])
p <- c(p1[1],rbind(p2,p1[-1]))
p[p<0] <- p[p<0]+366
p <- c(p, 365-sum(p))
cexf <- approxfun(range(p), c(3, 9), rule = 3)
# The first and the last site are in breeding habitat
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- tblLog$Lon[i]-sch[nrow(sch),7]
shift2Lat <- tblLog$Lat[i]-sch[nrow(sch),8]
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
p <- c(p1[1],rbind(p2,p1[-1]))
p[p<0] <- p[p<0]+366
p
p <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
p[(j-1)*2+1] <- round(as.numeric(difftime(sch$Departure[j],sch$Arrival[j],unit="days")),0)
if(j!=nrow(sch)) p[j*2] <- round(as.numeric(difftime(sch$Arrival[j+1],sch$Departure[j],unit="days")),0)
}
p
day
p <- c(p, 365-sum(p))
p
cexf <- approxfun(range(p), c(3, 9), rule = 3)
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- tblLog$Lon[i]-sch[nrow(sch),7]
shift2Lat <- tblLog$Lat[i]-sch[nrow(sch),8]
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
Seasonal_palette(365)[day]
day <- rep(0,nrow(sch))
for (j in 1:nrow(sch)){
day[j] <- yday(median(sch$Departure[j],sch$Arrival[j]))
}
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col = c("#FFFFFFFF","#000000FF",rbind(Seasonal_palette(365)[day],rep("#000000FF",length(day))),"#FFFFFFFF","#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c("",rbind(rep("",length(day)),1:length(day)),"","",""))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
c(rbind(as.character(sch[,1]),rep("",nrow(sch))))
c(rbind(rep("",nrow(sch)),as.character(sch[,1]))[-1])
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col =  c(rbind(rep("#000000FF",nrow(sch)),Seasonal_palette(365)[day])[-1],"#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c(rbind(rep("",nrow(sch)),as.character(sch[,1]))))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col =  c(rbind(rep("#000000FF",nrow(sch)),Seasonal_palette(365)[day])[-1],"#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c(rbind(rep("",nrow(sch)),as.character(sch[,1]))))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
day <- rep(0,nrow(sch))
for (j in 1:nrow(sch)){
day[j] <- yday(median(sch$Departure[j],sch$Arrival[j]))
print(median(sch$Departure[j],sch$Arrival[j]))
print(sch$Departure[j])
print(sch$Arrival[j])
}
day <- rep(0,nrow(sch))
for (j in 1:nrow(sch)){
day[j] <- yday(median(sch$Departure[j],sch$Arrival[j]))
print(median(sch$Departure[j],sch$Arrival[j]))
print(sch$Departure[j])
print(sch$Arrival[j])
print("")
}
getT(sch$Departure)
apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median)
apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median)
getT(apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median))
apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median)
as.POSIXlt(apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median), origin = "1970-01-01", tz  ="GMT")
yday(as.POSIXlt(apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median), origin = "1970-01-01", tz  ="GMT"))
day <- yday(as.POSIXlt(apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median), origin = "1970-01-01", tz  ="GMT"))
day <- yday(as.POSIXlt(apply(rbind(getT(sch$Departure),getT(sch$Arrival)),2,median), origin = "1970-01-01", tz  ="GMT"))
p <- rep(0,nrow(sch)*2-1)
for (j in 1:nrow(sch)){
p[(j-1)*2+1] <- round(as.numeric(difftime(sch$Departure[j],sch$Arrival[j],unit="days")),0)
if(j!=nrow(sch)) p[j*2] <- round(as.numeric(difftime(sch$Arrival[j+1],sch$Departure[j],unit="days")),0)
}
p <- c(p, 365-sum(p))
cexf <- approxfun(range(p), c(3, 9), rule = 3)
# The first and the last site are in breeding habitat
shift1Lon <- tblLog$Lon[i]-sch[1,7]
shift1Lat <- tblLog$Lat[i]-sch[1,8]
shift2Lon <- tblLog$Lon[i]-sch[nrow(sch),7]
shift2Lat <- tblLog$Lat[i]-sch[nrow(sch),8]
sch[1,c(7,10:13)] <- as.numeric(sch[1,c(7,10:13)])+shift1Lon
sch[1,c(8,14:17)] <- as.numeric(sch[1,c(8,14:17)])+shift1Lat
sch[nrow(sch),c(7,10:13)] <- as.numeric(sch[nrow(sch),c(7,10:13)])+shift2Lon
sch[nrow(sch),c(8,14:17)] <- as.numeric(sch[nrow(sch),c(8,14:17)])+shift2Lat
X11(width=1500,height=1000)
plot(c(-30,30),c(0,55),type="n", xlab="lon",ylab="lat",cex.axis=0.7,cex=1,main=paste("Track of",tblLog$MyLogID[i]))
map('world',add=TRUE, lwd=1,  col=grey(0.9),fill=T)
map('world',add=TRUE, lwd=2,  col=1)
box(lwd=2)
lines(c(tblLog$Lon[i],sch[1,7]), c(tblLog$Lat[i], sch[1,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[1]])
for(j in 2:nrow(sch)) lines(c(sch[j-1,7],sch[j,7]), c(sch[j-1,8], sch[j,8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[j]])
lines(c(tblLog$Lon[i],sch[nrow(sch),7]), c(tblLog$Lat[i], sch[nrow(sch),8]), lwd = 3, lty=3, col=Seasonal_palette(365)[day[nrow(sch)]])
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=25,bg=Seasonal_palette(365)[day[1]],cex=2,lwd=2)
points(tblLog$Lon[i],tblLog$Lat[i],col=1,pch=24,bg=Seasonal_palette(365)[day[nrow(sch)]],cex=2,lwd=2)
arrows(sch[,7], as.numeric(sch[,14]), sch[,7], as.numeric(sch[,17]), lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
arrows(as.numeric(sch[,10]), sch[,8], as.numeric(sch[,13]), sch[,8], lwd = 3, length = .05, col = Seasonal_palette(365)[day],angle=90,code=3)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*2, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.1), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp), bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.2), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.75, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.3), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.5, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.5), lwd = 2,col=NULL)
points(sch[,7], sch[,8], pch = 21, cex = cexf(stp)*.25, bg = adjustcolor(Seasonal_palette(365)[day], alpha.f = 0.8), lwd = 2,col=NULL)
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col =  c(rbind(rep("#000000FF",nrow(sch)),Seasonal_palette(365)[day])[-1],"#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c(rbind(rep("",nrow(sch)),as.character(sch[,1]))))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
box()
c(rbind(rep("",nrow(sch)),as.character(sch[,1])))
text(sch[,7], sch[,8], sch[,1], col = 1)
mapplots::add.pie(x = 27, y = 7, z = 1, radius = 7, col = grey(0.9), init.angle = 90 ,labels="")
mapplots::add.pie(x = 27, y = 7, z = p, radius = 6.5, col =  c(rbind(rep("#000000FF",nrow(sch)),Seasonal_palette(365)[day])[-1],"#FFFFFF00")
, init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=.85,font=2,border=NA,labels=rep("",length(day)*2+2))
mapplots::add.pie(x = 27, y = 7, z = p, radius = 5.5, col = grey(0.9), init.angle = 365+90-yday(getT(tblLog$LogONdate[i])),cex=.8,label.dist=1.05,font=2,border=NA,labels=c(rbind(as.character(sch[,1]),rep("",nrow(sch)))))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 5, col = Seasonal_palette(12), init.angle = 90 ,labels=rep("",12))
mapplots::add.pie(x = 27, y = 7, z = rep(1, 12), radius = 3, col = "white", init.angle = 90 ,labels=rep("",12), border=NA)
mapplots::add.pie(x = 27, y = 7, z = c(.6,1,1.2,1.2,1,.6,.6,1,1.2,1.2,1,.6), radius = 3, col = NA, init.angle = 90, border=NA ,cex=.6,label.dist=1.2,font=2,labels=c("Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"))
dsfg
blogdown::serve_site()
library(blogdown)
#install_hugo()
blogdown::update_hugo()
setwd("C:/Users/Cme/Documents/GitHub/MigrationWebsite2019/")
setwd("C:/Users/Cme/Documents/GitHub/P3webpage/")
blogdown::serve_site()
dir()
?blogdown::build_site
servr::jekyll
?servr::jekyll
